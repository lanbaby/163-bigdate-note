## 扩展一个系统

- 分布式系统设计之CAP理论

    - Consistency：分布式一致性

        - 强一致性：系统中所有节点的数据状态（版本）是相同的。

    - Availability：系统可用性

        - 系统会处理和相应每个请求。

    - Partition-tolerance：分区可容忍性

        - 如果一些节点宕机或者网络故障，还能提供服务。

- 分布式系统CAP理论：至少满足两个条件。

    - CA：也就是情调一致性C和可用性A，放弃分区容忍性P，最简单的做法是把所有与事务相关的内容都放到同一台机器上。很显然，这种做法会严重影响系统的可扩展性，传统数据库（MySQL、SQL、Server和PostgreSQL），都采用了这种设计原则，因此，扩展性都比较差。

    - CP：也就是强调一致性C和分区容忍性P，放弃可用性A，当出现网络分区的情况时，受影响的服务需要等待数据一致性，因此在等待期间就无法对外提供服务。

    -AP：也就是强调可用性A和分区容忍性P，放弃一致性C，允许系统返回不一致的数据。

- 辩证地看待三者的关系

    - 三个例子：

        - 车站售票要保证强一致性，否则可能出现同一个座位售出两张票的结果。

        - 银行转账不需要强一致性，几个工作日到账即可。

        - 网上购物不需要强一致性，最终下订单时保证一致性即可。
    
    - 上面三个例子说明不同业务场景下对一种的要求也不一样，要根据具体业务确定一致性。

- 好多一致性

    - 强一致性：一旦对数据修改，所有后续的读请求，读到的都是最新的版本。

    - 弱一致性：数据修改之后，不保证后续的读请求会读到最新的版本。

    - 最终一致性：弱一致性的特殊形式。在一次数据修改之后，最终所有的请求都会拿到最新的版本。